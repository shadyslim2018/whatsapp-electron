# Maintainer: AK <you@example.com>
pkgname=whatsapp-electron
pkgver=1.0.0
pkgrel=1
pkgdesc="Unofficial WhatsApp Web desktop wrapper (Electron) â€“ runs with system Electron"
arch=('x86_64')
url="https://github.com/shadyslim2018/whatsapp-electron"
license=('MIT')
depends=('electron' 'gtk3' 'nss' 'libxss' 'libnotify' 'xdg-utils')  # xdg-open for external links
makedepends=()
source=(
  'main.js'
  'package.json'
  'icon.png'
  'whatsapp-electron.desktop'
)
sha256sums=('SKIP' 'SKIP' 'SKIP' 'SKIP')

build() {
  # No build step needed (we use system Electron).
  :
}

package() {
  # App payload
  install -d "$pkgdir/usr/lib/whatsapp-electron"
  install -m644 "$srcdir/main.js"      "$pkgdir/usr/lib/whatsapp-electron/main.js"
  install -m644 "$srcdir/package.json" "$pkgdir/usr/lib/whatsapp-electron/package.json"
  install -m644 "$srcdir/icon.png"     "$pkgdir/usr/lib/whatsapp-electron/icon.png"

  # Launcher
  install -d "$pkgdir/usr/bin"
  printf '#!/bin/sh\nexec /usr/bin/electron /usr/lib/whatsapp-electron "$@"\n' \
    > "$pkgdir/usr/bin/whatsapp-electron"
  chmod 755 "$pkgdir/usr/bin/whatsapp-electron"

  # Desktop entry + menu icon
  install -Dm644 "$srcdir/whatsapp-electron.desktop" \
    "$pkgdir/usr/share/applications/whatsapp-electron.desktop"
  install -Dm644 "$srcdir/icon.png" \
    "$pkgdir/usr/share/icons/hicolor/256x256/apps/whatsapp-electron.png"
}
